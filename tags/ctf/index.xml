<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ctf on yuasa's blog</title><link>/tags/ctf/</link><description>Recent content in ctf on yuasa's blog</description><generator>Hugo -- gohugo.io</generator><language>ja</language><copyright>Â© yuasa</copyright><lastBuildDate>Sun, 17 Sep 2023 23:03:10 +0900</lastBuildDate><atom:link href="/tags/ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>SECCON CTF 2023 Quals writeup</title><link>/posts/40/</link><pubDate>Sun, 17 Sep 2023 23:03:10 +0900</pubDate><guid>/posts/40/</guid><description>ã¯ã˜ã‚ã« 2023-09-16 05:00 UTC - 2023-09-17 05:00 UTC ã§SECCON CTF 2023 QualsãŒé–‹å‚¬ã•ã‚Œã¾ã—ãŸã€‚
ãƒãƒ¼ãƒ ONsenã§å‚åŠ ã—ã€å›½éš›90/653ä½ã€å›½å†…37/334ä½ã§ã—ãŸã€‚
åƒ•ã¯Webã®warmupå•é¡Œã§ã‚ã‚‹Bad JWTã‚’è§£ã„ãŸã®ã¿ã§ã€ãã®ä»–ã®webå•é¡Œã«å…¨ãæ­¯ãŒç«‹ãŸãšã«ãƒ™ãƒ³ãƒã‚’æ¸©ã‚ã¦ã„ã¾ã—ãŸã€‚
å‚åŠ ã«ã‚ãŸã£ã¦ ãƒãƒ¼ãƒ ONsenã¯åƒ•ã®ç ”ç©¶å®¤ã®å¾Œè¼©ã§ã‚ã‚‹Yå›ãŒé˜ªå¤§åœ¨ç±æ™‚ã«ã€Œæ‰“å€’ï¼Wâ—¯ni Hackâ—‹seï¼ã€ã‚’ã‚¹ãƒ­ãƒ¼ã‚¬ãƒ³ã«è¨­ç«‹ã—ãŸãƒãƒ¼ãƒ ã§ã‚ã‚Šï¼ˆå˜˜ï¼‰ã€é˜ªå¤§ã¨NAISTã®å­¦ç”ŸãŒæ‰€å±ã—ã¦ã„ã¾ã™ã€‚è‡ªåˆ†ã‚‚ONsenã«æ‰€å±ã—ã¦ãŠã‚Šã€Yå›ãŒå¾Œã‚ã®å¸­ã§ã€ŒSECCONäºˆé¸ã§Wâ—¯ni Hackâ—‹seå€’ã—ã¦ãˆãªã‚ã€ã¨æ¯æ—¥å£ãšã•ã‚“ã§ãŠã‚Šï¼ˆå˜˜ï¼‰ã€ææ€–ã‚’æ„Ÿã˜ãŸãŸã‚ã€ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®è£œå¼·ã‚’ä¼ã‚“ã§ã„ã¾ã—ãŸã€‚
ã™ã‚‹ã¨ã€è‡ªåˆ†ãŒæ™®æ®µã‹ã‚‰ãƒ„ã‚¤ãƒ¼ãƒˆã‚„ãƒ–ãƒ­ã‚°ã‚’æ‹è¦‹ã—ã¦ã„ã‚‹ã¤ã‚ˆã¤ã‚ˆCTFãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã‚ã‚‹hamayanã•ã‚“ãŒå‚åŠ ã™ã‚‹ãƒãƒ¼ãƒ ã‚’æ¢ã—ã¦ã„ã‚‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ã€‚
SECCONãƒãƒ¼ãƒ å…¥ã‚Œã¦ãã‚Œã‚‹å¿ƒå„ªã—ã„äººã„ã¾ã›ã‚“ã‹
&amp;mdash; hamayanhamayan (@hamayanhamayan) September 4, 2023 ã€Œã“ã‚Œã¯ã€ãƒãƒ£ãƒ³ã‚¹ï¼ã€ã¨æ€ã£ãŸã®ã§ã€é€Ÿæ”»å‹§èª˜ã•ã›ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚ã™ã‚‹ã¨ã€ã¾ã•ã‹ã®OKã‚’ã„ãŸã ãã€hamayanã•ã‚“ãŒONsenã§SECCONäºˆé¸ã«å‚åŠ ã—ã¦ãã ã•ã‚‹ã“ã¨ãŒç¢ºå®šã—ã¾ã—ãŸã€‚
è¿½åŠ ã§NAISTæœ€å¼·ã®pwner()ã§ã‚ã‚‹ãŠã—ã¼ã‚Šã‚’ONsenã«åŠ å…¥ã•ã›ã‚‹ã“ã¨ã«æˆåŠŸã—ã¾ã—ãŸã€‚
ã“ã‚Œã§SECCONäºˆé¸ã§ã®åƒ•ã®ä»•äº‹ã¯çµ‚ã‚ã£ãŸã¨è¨€ãˆã¾ã™ã€‚å½“æ—¥ã¯ãƒ™ãƒ³ãƒã‚’æ¸©ã‚ã‚‰ã‚Œã‚‹ã“ã¨ãŒç¢ºå®šã—ã¾ã—ãŸã€‚
[web] Bad JWT Satoooonã•ã‚“ã®JWTå•ã§ã™ã€‚
jwt.js
const crypto = require(&amp;#39;crypto&amp;#39;); const base64UrlEncode = (str) =&amp;gt; { return Buffer.from(str) .toString(&amp;#39;base64&amp;#39;) .replace(/=*$/g, &amp;#39;&amp;#39;) .replace(/\+/g, &amp;#39;-&amp;#39;) .replace(/\//g, &amp;#39;_&amp;#39;); } const base64UrlDecode = (str) =&amp;gt; { return Buffer.from(str, &amp;#39;base64&amp;#39;).toString(); } const algorithms = { hs256: (data, secret) =&amp;gt; base64UrlEncode(crypto.</description></item><item><title>pwnable.tw writeup</title><link>/posts/37/</link><pubDate>Mon, 26 Jun 2023 23:15:47 +0900</pubDate><guid>/posts/37/</guid><description>pwnable.twã‚’è§£ã„ã¦ã„ãã¾ã™ã€‚è§£ã‘ãªãã¦ã‚‚è§£æ³•ã¯ã¾ã¨ã‚ã¾ã™ã€‚
Start Just a start.
nc chall.pwnable.tw 10000
start
èª¿æŸ» å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒä¸ãˆã‚‰ã‚Œã‚‹ã€‚
file start start: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ã€æ–‡å­—åˆ—ãŒå…¥åŠ›ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ãŸãã•ã‚“æ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹ã¨Segmentation faultãŒç™ºç”Ÿã™ã‚‹ã€‚
# ./start Let&amp;#39;s start the CTF: # ./start Let&amp;#39;s start the CTF:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa Segmentation fault gdbã§å®Ÿè¡Œã—ã¦ã¿ã‚‹ã€‚è©¦ã—ã«50æ–‡å­—å…¥åŠ›ã—ã¦ã¿ã‚‹ã¨EIPãŒæ›¸ãæ›ãˆã‚‰ã‚Œã‚‹ã€‚
# gdb -q start gdb-peda$ pattc 50 &amp;#39;AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbA&amp;#39; gdb-peda$ r Starting program: /ctf/Start/start Let&amp;#39;s start the CTF:AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbA Program received signal SIGSEGV, Segmentation fault. [----------------------------------registers-----------------------------------] EAX: 0x33 (&amp;#39;3&amp;#39;) EBX: 0x0 ECX: 0xffffd7b4 (&amp;#34;AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) EDX: 0x3c (&amp;#39;&amp;lt;&amp;#39;) ESI: 0x0 EDI: 0x0 EBP: 0x0 ESP: 0xffffd7cc (&amp;#34;(AADAA;AA)AAEAAaAA0AAFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) EIP: 0x41412d41 (&amp;#39;A-AA&amp;#39;) EFLAGS: 0x10282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow) [-------------------------------------code-------------------------------------] Invalid $PC address: 0x41412d41 [------------------------------------stack-------------------------------------] 0000| 0xffffd7cc (&amp;#34;(AADAA;AA)AAEAAaAA0AAFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) 0004| 0xffffd7d0 (&amp;#34;AA;AA)AAEAAaAA0AAFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) 0008| 0xffffd7d4 (&amp;#34;A)AAEAAaAA0AAFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) 0012| 0xffffd7d8 (&amp;#34;EAAaAA0AAFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) 0016| 0xffffd7dc (&amp;#34;AA0AAFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) 0020| 0xffffd7e0 (&amp;#34;AFAAbA\n\377:\331\377\377E\331\377\377Q\331\377\377`\331\377\377k\331\377\377v\331\377\377\275\331\377\377\237\337\377\377\301\337\377\377\320\337\377\377\331\337\377\377&amp;#34;) 0024| 0xffffd7e4 --&amp;gt; 0xff0a4162 0028| 0xffffd7e8 --&amp;gt; 0xffffd93a (&amp;#34;HOME=/root&amp;#34;) [------------------------------------------------------------------------------] Legend: code, data, rodata, value Stopped reason: SIGSEGV 0x41412d41 in ?</description></item><item><title>SECCON Beginners CTF 2023[Web] double check, oooauth ä½œå•è€…writeup</title><link>/posts/36/</link><pubDate>Sun, 04 Jun 2023 14:14:37 +0900</pubDate><guid>/posts/36/</guid><description>SECCON Beginners CTF 2023ã§å‡ºé¡Œã—ãŸWebå•é¡Œdouble checkã€oooauthã®ä½œå•è€…writeupã§ã™ã€‚ double checkï¼ˆé›£æ˜“åº¦ Mediumï¼‰ JWTã‚’ç”¨ã„ãŸèªè¨¼æ©Ÿèƒ½ã®è„†å¼±æ€§ã¨Prototype Pollutionã®è„†å¼±æ€§ã‚’é€£é–çš„ã«æ‚ªç”¨ã™ã‚‹å•é¡Œã§ã™ã€‚
å•é¡Œã®å®Ÿè£…ã¯ä»¥ä¸‹ã§ã™ã€‚
const express = require(&amp;#34;express&amp;#34;); const session = require(&amp;#34;express-session&amp;#34;); const jwt = require(&amp;#34;jsonwebtoken&amp;#34;); const _ = require(&amp;#34;lodash&amp;#34;); const { readKeyFromFile, generateRandomString, getAdminPassword } = require(&amp;#34;./utils&amp;#34;); const HOST = process.env.CTF4B_HOST; const PORT = process.env.CTF4B_PORT; const FLAG = process.env.CTF4B_FLAG; const app = express(); app.use(express.json()); app.use(session({ secret: generateRandomString(), resave: false, saveUninitialized: true, cookie: { secure: false } })); app.post(&amp;#34;/register&amp;#34;, (req, res) =&amp;gt; { const { username, password } = req.</description></item><item><title>[waniCTF 2023] writeup(web)</title><link>/posts/35/</link><pubDate>Sat, 06 May 2023 15:00:37 +0900</pubDate><guid>/posts/35/</guid><description>waniCTF 2023ãŒ2023/5/4(Thu) 15:00 ~ 2023/5/6(Sat) 15:00(JST)ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸã€‚
[web] IndexedDB ã“ã®ãƒšãƒ¼ã‚¸ã®ã©ã“ã‹ã«ãƒ•ãƒ©ã‚°ãŒéš ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦æ¢ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
It appears that the flag has been hidden somewhere on this page. Let&amp;rsquo;s use the browser&amp;rsquo;s developer tools to find it.
https://indexeddb-web.wanictf.org
/ã‚’curlã§GETã™ã‚‹ã¨flagã‚’indexedDBã«æ ¼ç´ã™ã‚‹javascriptãŒå«ã¾ã‚Œã‚‹ãƒšãƒ¼ã‚¸ãŒè¿”ã•ã‚Œã¾ã™ã€‚
$ curl https://indexeddb-web.wanictf.org/ &amp;lt;!DOCTYPE html&amp;gt; &amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;meta charset=&amp;#34;utf-8&amp;#34; /&amp;gt; &amp;lt;/head&amp;gt; &amp;lt;body&amp;gt; &amp;lt;/body&amp;gt; &amp;lt;script&amp;gt; var connection; window.onload = function () { var openRequest = indexedDB.open(&amp;#34;testDB&amp;#34;); openRequest.onupgradeneeded = function () { connection = openRequest.result; var objectStore = connection.createObjectStore(&amp;#34;testObjectStore&amp;#34;, { keyPath: &amp;#34;name&amp;#34;, }); objectStore.</description></item><item><title>[Ã¥ngstromCTF 2023] My own writeup</title><link>/posts/34/</link><pubDate>Thu, 27 Apr 2023 09:06:37 +0900</pubDate><guid>/posts/34/</guid><description>Ã¥ngstromCTF 2023ãŒ2023/04/23 0:00 - 2023/04/27 0:00 (UTC)ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸã€‚
[web] catch me if you can ãƒšãƒ¼ã‚¸ã®sourceã«flagãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚
$ curl https://catch-me-if-you-can.web.actf.co/ | grep &amp;#34;actf{&amp;#34; % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 1141 100 1141 0 0 143 0 0:00:07 0:00:07 --:--:-- 307 &amp;lt;marquee scrollamount=&amp;#34;50&amp;#34; id=&amp;#34;flag&amp;#34;&amp;gt;actf{y0u_caught_m3!_0101ff9abc2a724814dfd1c85c766afc7fbd88d2cdf747d8d9ddbf12d68ff874}&amp;lt;/marquee&amp;gt; [web] Celeste Speedrunning Association / ã‚’GETã™ã‚‹ã¨ã€ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
Welcome to Celeste speedrun records!!! Current record holders (beat them at /play for a flag!</description></item><item><title>[RICERCA CTF 2023] My own writeup</title><link>/posts/33/</link><pubDate>Mon, 24 Apr 2023 10:19:57 +0900</pubDate><guid>/posts/33/</guid><description>RICERCA CTF 2023ãŒ2023/04/22 10:00 - 2023/04/22 22:00 (UTC+9)ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸã€‚
[web] Cat CafÃ© çŒ«ãŒã‹ã‚ã„ã„ã§ã™ã­ã€‚
app.pyã¯ä»¥ä¸‹ã§ã™ã€‚
import flask import os app = flask.Flask(__name__) @app.route(&amp;#39;/&amp;#39;) def index(): return flask.render_template(&amp;#39;index.html&amp;#39;) @app.route(&amp;#39;/img&amp;#39;) def serve_image(): filename = flask.request.args.get(&amp;#34;f&amp;#34;, &amp;#34;&amp;#34;).replace(&amp;#34;../&amp;#34;, &amp;#34;&amp;#34;) path = f&amp;#39;images/{filename}&amp;#39; if not os.path.isfile(path): return flask.abort(404) return flask.send_file(path) if __name__ == &amp;#39;__main__&amp;#39;: app.run() /imgã«è©²å½“ã™ã‚‹éƒ¨åˆ†ã‚’ã¿ã‚‹ã¨ã€[URL]/img?f=01.jpgã®ã‚ˆã†ã«ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä»‹ã—ã¦imagesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
@app.route(&amp;#39;/img&amp;#39;) def serve_image(): filename = flask.request.args.get(&amp;#34;f&amp;#34;, &amp;#34;&amp;#34;).replace(&amp;#34;../&amp;#34;, &amp;#34;&amp;#34;) path = f&amp;#39;images/{filename}&amp;#39; if not os.path.isfile(path): return flask.abort(404) return flask.send_file(path) flagãŒæ›¸ã‹ã‚ŒãŸflag.txtã¯imagesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸€ã¤ä¸Šã®éšå±¤ã«ã‚ã‚‹ãŸã‚ã€[URL]/img?f=../flag.txtã®ã‚ˆã†ã«ã—ã¦flagãŒå–å¾—ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¾ã™ãŒã€ä»¥ä¸‹ã®éƒ¨åˆ†ã§../ãŒç©ºæ–‡å­—ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ãŸã‚ä¸å¯èƒ½ã§ã™ã€‚
filename = flask.</description></item><item><title>[LINE CTF 2023] My own writeup</title><link>/posts/32/</link><pubDate>Sun, 26 Mar 2023 01:00:02 +0100</pubDate><guid>/posts/32/</guid><description>LINE CTF 2023ãŒMarch 25, 2023, 09:00 AM ~ March 26, 2023, 09:00 AM (UTC+9)ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸã€‚
[web] Baby Simple GoCurl package main import ( &amp;#34;errors&amp;#34; // &amp;#34;fmt&amp;#34; &amp;#34;io/ioutil&amp;#34; &amp;#34;log&amp;#34; &amp;#34;net/http&amp;#34; &amp;#34;os&amp;#34; &amp;#34;strings&amp;#34; &amp;#34;github.com/gin-gonic/gin&amp;#34; ) func redirectChecker(req *http.Request, via []*http.Request) error { reqIp := strings.Split(via[len(via)-1].Host, &amp;#34;:&amp;#34;)[0] if len(via) &amp;gt;= 2 || reqIp != &amp;#34;127.0.0.1&amp;#34; { return errors.New(&amp;#34;Something wrong&amp;#34;) } return nil } func main() { flag := os.Getenv(&amp;#34;FLAG&amp;#34;) r := gin.Default() r.LoadHTMLGlob(&amp;#34;view/*.html&amp;#34;) r.Static(&amp;#34;/static&amp;#34;, &amp;#34;.</description></item><item><title>[taskctf22] My own writeup</title><link>/posts/29/</link><pubDate>Sun, 04 Dec 2022 00:53:41 +0900</pubDate><guid>/posts/29/</guid><description>2022/12/03(Sat) 00:00(JST) ~ 2022/12/04(Sun) 00:00(JST)ã®æ—¥ç¨‹ã§é–‹å‚¬ã•ã‚ŒãŸtaskctf22ã«å‚åŠ ã—ã¾ã—ãŸ.
ãƒ¦ãƒ¼ã‚¶ãƒ¼åyuasaã§å‚åŠ ã—, 1814ãƒã‚¤ãƒ³ãƒˆç²å¾—ã—ã¦24ä½ã§ã—ãŸ. writeupã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™.
[osint] welcome å•é¡Œ 2019å¹´ã®taskctfã®welcomeå•é¡Œã®Flagã¯ä½•ã§ã—ãŸã£ã‘ï¼Ÿ
è§£æ³• taskctf 2019ã§æ¤œç´¢ã™ã‚‹ã¨st98ã•ã‚“ã®writeupãŒè¦‹ã¤ã‹ã‚Šã€ãã“ã«welcomeå•é¡Œã®flagãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã—ãŸã€‚
taskctf{let&amp;#39;s_enj0y!} [web] robots å•é¡Œ FlagãŒæ¼æ´©ã—ã¦ã‚‹ã£ã¦èã„ãŸã‘ã©ã€æœ¬å½“ã§ã™ã‹ï¼Ÿï¼Ÿï¼Ÿ
http://34.82.208.2:31481/
è§£æ³• å•é¡Œåã‹ã‚‰æ¨æ¸¬ã—ã¦robots.txtã‚’è¦‹ã¦ã¿ã‚‹ã¨, /admin/flagã¨ã„ã†ãƒ‘ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™.
$ curl http://34.82.208.2:31481/robots.txt User-Agent: * Disallow: /admin/flag% /admin/flagã‚’è¦‹ã‚‹ã¨, å†…éƒ¨ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã¯ãªã„ã‹ã‚‰ãƒ€ãƒ¡ã¨è¨€ã‚ã‚Œã¾ã™.
$ curl http://34.82.208.2:31481/admin/flag ... &amp;lt;div class=&amp;#34;container&amp;#34;&amp;gt; &amp;lt;h1&amp;gt;401 Unauthorized&amp;lt;/h1&amp;gt; &amp;lt;p&amp;gt;153.246.178.236 is not internal IP address :(&amp;lt;/p&amp;gt; &amp;lt;/div&amp;gt; ... ã‚ã‚‹ã‚ã‚‹ã®æ‰‹æ³•ã§ã‚ã‚‹X-Forwarded-Forãƒ˜ãƒƒãƒ€ãƒ¼ã‚’127.0.0.1ã«æ›¸ãæ›ãˆã‚‹ã‚„ã¤ã‚’è©¦ã™ã¨flagãŒå–å¾—ã§ãã¾ã—ãŸ.
$ curl -H &amp;#39;X-Forwarded-For: 127.0.0.1&amp;#39; http://34.82.208.2:31481/admin/flag ... &amp;lt;h1&amp;gt;flag&amp;lt;/h1&amp;gt; &amp;lt;p&amp;gt;taskctf{th15_c0ntr0l_y0u_th1nk_y0u_h4ve_1s_4n_1llu5i0n}&amp;lt;/p&amp;gt; taskctf{th15_c0ntr0l_y0u_th1nk_y0u_h4ve_1s_4n_1llu5i0n} [web] first å•é¡Œæ–‡ é‹å–¶ã—ã¦ã„ã‚‹å°ã•ãªæ²ç¤ºæ¿ãŒ100ãƒ¦ãƒ¼ã‚¶ã‚’é”æˆã—ã¾ã—ãŸ ğŸ‰
ãã“ã§ã€ãƒ¡ãƒ³ãƒ†æ˜ã‘ã®12/6ã«100ç•ªç›®ã¡ã‚‡ã†ã©ã®ç™»éŒ²ã‚’ã—ãŸãƒ¦ãƒ¼ã‚¶ã‚’ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã§æ²è¼‰ã—ãŸã„ã®ã§ã€ãƒ¦ãƒ¼ã‚¶åã‚’ taskctf{ãƒ¦ãƒ¼ã‚¶å} ã§æ•™ãˆã¦ãã ã•ã„ï¼
http://34.82.208.2:31555/</description></item><item><title>[TsukuCTF 2022] My own writeup</title><link>/posts/25/</link><pubDate>Mon, 24 Oct 2022 00:11:07 +0900</pubDate><guid>/posts/25/</guid><description>TsukuCTF 2022ãŒ10/22 12:20 - 10/23 18:00(JST)ã®æ—¥ç¨‹ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸ. webã‚’è§£ã„ã¦ã„ãŸã®ã§, ãã®writeupã‚’ä»¥ä¸‹ã«è¨˜ã—ã¾ã™.
[web] bughunter(86 solves) [web] viewer(8 solves, not solved) [web] bughunter(86 solves) å•é¡Œæ–‡ å¤©æ‰ãƒãƒƒã‚«ãƒ¼ã®ã¤ãã—å›ã¯ã€ã©ã‚“ãªã‚µã‚¤ãƒˆã®è„†å¼±æ€§ã§ã‚‚è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã‚ãªãŸã‚‚å½¼ã®ã‚ˆã†ã«ã“ã®ã‚µã‚¤ãƒˆã®è„†å¼±æ€§ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ è¦‹ã¤ã‘ãŸã‚‰ç§ãŸã¡ã«å ±å‘Šã—ã¦ãã ã•ã„ã€‚ â€»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç·å½“ãŸã‚Šãªã©ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚æœ¬å•é¡Œã®è§£æ±ºã«ã¯ã€å¤šæ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ä¸è¦ã§ã™ã€‚
http://133.130.103.51:31415
è§£æ³• å•é¡Œã«RFC9116ãŒã‚¿ã‚°ä»˜ã‘ã•ã‚Œã¦ã„ã¾ã™. RFC9116ã§æ¤œç´¢ã™ã‚‹ã¨, ã“ã¡ã‚‰ã®ãƒšãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã™.
RFC9116ã¯ã€çµ„ç¹”ãŒè„†å¼±æ€§ã®é–‹ç¤ºæ–¹æ³•ã‚’èª¬æ˜ã—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç ”ç©¶è€…ãªã©ãŒç™ºè¦‹ã—ãŸè„†å¼±æ€§ã‚’å ±å‘Šã—ã‚„ã™ãã™ã‚‹ãŸã‚ã«å®šç¾©ã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚ã“ã®ä»•çµ„ã¿ã¯å˜ç´”ã§ã€å¿…è¦ãªæƒ…å ±ã‚’è¨˜è¼‰ã—ãŸã€Œsecurity.txtã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Webã‚µã‚¤ãƒˆã®ã€Œ/.well-known/ã€ãƒ‘ã‚¹ã®ä¸‹ã«å…¬é–‹ã™ã‚‹ã“ã¨ã‚’è¦æ±‚ã—ã¦ã„ã¾ã™ã€‚ã€Œsecurity.txtã€ã«ã¯æ¬¡ã®é …ç›®ãŒè¨˜è¿°ã•ã‚Œã¾ã™ã€‚
å®Ÿéš›ã«/.well-known/security.txtã‚’GETã™ã‚‹ã¨, flagãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã—ãŸ.
$ curl &amp;#34;http://133.130.103.51:31415/.well-known/security.txt&amp;#34; Contact: TsukuCTF22{y0u_c4n_c47ch_bu65_4ll_y34r_r0und_1n_7h3_1n73rn37} Expires: 2022-10-20T15:00:00.000Z Preferred-Languages: ja, en% [web] viewer(8 solves, not solved) å•é¡Œæ–‡ Writeups for TsukuCTF21 have been published. Check them out if you&amp;rsquo;d like!
URL
è§£æ³• è§£ã‘ã¾ã›ã‚“ã§ã—ãŸ. é…å¸ƒã‚³ãƒ¼ãƒ‰ã®app.pyã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™.
from flask import ( Flask, abort, make_response, render_template, request, redirect ) import redis import pycurl from io import BytesIO import traceback import uuid import json app = Flask(__name__) # initialization redis = redis.</description></item><item><title>[CakeCTF 2022] My own writeup</title><link>/posts/24/</link><pubDate>Sun, 04 Sep 2022 23:11:19 +0900</pubDate><guid>/posts/24/</guid><description>CakeCTF 2022ãŒ9/3 14:00 - 9/4 14:00(JST)ã®æ—¥ç¨‹ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸ. webã‚’è§£ã„ã¦ã„ãŸã®ã§, ãã®writeupã‚’ä»¥ä¸‹ã«è¨˜ã—ã¾ã™.
[web] CakeGEAR(104 solves) [web] OpenBio(50 solves) [web] CakeGEAR(104 solves) $_SESSION['admin']ãŒtrueã«ãªã‚Œã°flagãŒå–ã‚Œã‚‹ã‚ˆã†ã§ã™.
if ($_SESSION[&amp;#39;admin&amp;#39;] === true) { $mode = &amp;#39;admin&amp;#39;; $flag = file_get_contents(&amp;#34;/flag.txt&amp;#34;); } else { $mode = &amp;#39;guest&amp;#39;; $flag = &amp;#34;***** Access Denied *****&amp;#34;; } usernameã‚’godmodeã¾ãŸã¯adminã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚Œã°$_SESSION['admin']ã‚’trueã«ã§ããã†ã§ã™. adminã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¨æ¸¬ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚é›£ã—ã„ã§ã™.
switch ($req-&amp;gt;username) { case &amp;#39;godmode&amp;#39;: /* No password is required in god mode */ $_SESSION[&amp;#39;login&amp;#39;] = true; $_SESSION[&amp;#39;admin&amp;#39;] = true; break; case &amp;#39;admin&amp;#39;: /* Secret password is required in admin mode */ if (sha1($req-&amp;gt;password) === ADMIN_PASSWORD) { $_SESSION[&amp;#39;login&amp;#39;] = true; $_SESSION[&amp;#39;admin&amp;#39;] = true; } break; case &amp;#39;guest&amp;#39;: /* Guest mode (low privilege) */ if ($req-&amp;gt;password === &amp;#39;guest&amp;#39;) { $_SESSION[&amp;#39;login&amp;#39;] = true; $_SESSION[&amp;#39;admin&amp;#39;] = false; } break; } usernameã‚’godmodeã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã«ã¯ä¸Šã®switchæ–‡ä»¥å‰ã§, æ¥ç¶šå…ƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ'127.</description></item><item><title>[DiceCTF @ HOPE 2022] My own writeup</title><link>/posts/22/</link><pubDate>Mon, 25 Jul 2022 03:00:01 +0900</pubDate><guid>/posts/22/</guid><description>DiceCTF @ HOPE 2022ãŒ7/23 3:00 - 7/25 3:00(JST)ã®æ—¥ç¨‹ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸ. webã‚’è§£ã„ã¦ã„ãŸã®ã§, ãã®writeupã‚’ä»¥ä¸‹ã«è¨˜ã—ã¾ã™.
[web] secure-page(293 solves) [web] reverser(225 solves) [web] flag-viewer(217 solves) [web] pastebin(139 solves) [web] point(111 solves) [web] oeps(83 solves) [web] secure-page(293 solves) cookieã¨ã—ã¦admin=trueã‚’é€ä¿¡ã™ã‚‹ã¨, flagãŒå¾—ã‚‰ã‚Œã‚‹ã‚ˆã†ã§ã™.
admin = request.cookies.get(&amp;#39;admin&amp;#39;, &amp;#39;&amp;#39;) headers = {} if admin == &amp;#39;&amp;#39;: headers[&amp;#39;set-cookie&amp;#39;] = &amp;#39;admin=false&amp;#39; if admin == &amp;#39;true&amp;#39;: return (200, &amp;#39;&amp;#39;&amp;#39; &amp;lt;title&amp;gt;Secure Page&amp;lt;/title&amp;gt; &amp;lt;link rel=&amp;#34;stylesheet&amp;#34; href=&amp;#34;/style.css&amp;#34; /&amp;gt; &amp;lt;div class=&amp;#34;container&amp;#34;&amp;gt; &amp;lt;h1&amp;gt;Secure Page&amp;lt;/h1&amp;gt; %s &amp;lt;/div&amp;gt; &amp;#39;&amp;#39;&amp;#39; % os.environ.get(&amp;#39;FLAG&amp;#39;, &amp;#39;flag is missing!</description></item><item><title>[SECCON Beginners CTF 2022] My own writeup</title><link>/posts/20/</link><pubDate>Sun, 05 Jun 2022 13:38:35 +0900</pubDate><guid>/posts/20/</guid><description>SECCON Beginners CTF 2022ãŒSat, June 04, 14:00 â€” Sun, June 05, 14:00 (JST)ã®æ—¥ç¨‹ã§é–‹å‚¬ã•ã‚Œã¾ã—ãŸ. ä»Šå›ã¯gaidailove(ç ”ç©¶å®¤ã®åŒæœŸãƒãƒ¼ãƒ )ã¨ã—ã¦å‚åŠ ã—ã¾ã—ãŸ. æœ€çµ‚çš„ã«ã¯654ãƒã‚¤ãƒ³ãƒˆç²å¾—ã—, 131/891ä½ã§ã—ãŸ.
åƒ•ã¯webã‚’è§£ã„ã¦ã„ãŸã®ã§, ãã®writeupã‚’ä»¥ä¸‹ã«è¨˜ã—ã¾ã™.
[web] Util é…å¸ƒãƒ•ã‚¡ã‚¤ãƒ«main.goã®ä»¥ä¸‹ã®éƒ¨åˆ†ã«è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™. ã‚³ãƒãƒ³ãƒ‰ã«ä»»æ„ã®æ–‡å­—åˆ—ã‚’æŒ¿å…¥ã§ãã‚‹ã®ã§, OSã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒå¯èƒ½ã§ã™.
r.POST(&amp;#34;/util/ping&amp;#34;, func(c *gin.Context) { var param IP if err := c.Bind(&amp;amp;param); err != nil { c.JSON(400, gin.H{&amp;#34;message&amp;#34;: &amp;#34;Invalid parameter&amp;#34;}) return } commnd := &amp;#34;ping -c 1 -W 1 &amp;#34; + param.Address + &amp;#34; 1&amp;gt;&amp;amp;2&amp;#34; result, _ := exec.Command(&amp;#34;sh&amp;#34;, &amp;#34;-c&amp;#34;, commnd).CombinedOutput() c.JSON(200, gin.H{ &amp;#34;result&amp;#34;: string(result), }) }) ã¾ãŸ, flagã¯/flag_$(cat /dev/urandom | tr -dc &amp;quot;a-zA-Z0-9&amp;quot; | fold -w 16 | head -n 1).</description></item><item><title>[Ã¥ngstromCTF 2022] My own writeup</title><link>/posts/13/</link><pubDate>Thu, 05 May 2022 09:05:01 +0900</pubDate><guid>/posts/13/</guid><description>Ã¥ngstromCTF 2022 was held at Sat, April 30, 00:00 â€” Wed, May 04, 23:59 (UTC). Since I mainly solved the web, I will write the writeup.
[web] The Flash Problem Statement :
The new Justice League movies nerfed the Flash, so clam made his own rendition! Can you get the flag before the Flash swaps it out at the speed of light? Problem Server : https://the-flash.web.actf.co/
Basically, the dummy flag is displayed on the web page, but the real flag is displayed for a moment.</description></item><item><title>ã€IMCTF 2021ã€‘å…¬å¼writeup cryptoç·¨ï¼ˆstatic randomğŸ‘½é™¤ãï¼‰</title><link>/posts/11/</link><pubDate>Sun, 19 Dec 2021 14:30:28 +0900</pubDate><guid>/posts/11/</guid><description>ã“ã®è¨˜äº‹ã¯Qiitaã«æŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã™ã€‚</description></item><item><title>ã€SECCON Begginers CTF 2021ã€‘ä¿ºãªã‚Šã®writeup</title><link>/posts/9/</link><pubDate>Mon, 24 May 2021 14:28:55 +0900</pubDate><guid>/posts/9/</guid><description>ã“ã®è¨˜äº‹ã¯Qiitaã«æŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã™ã€‚</description></item></channel></rss>