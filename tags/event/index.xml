<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>event on yuasa's blog</title><link>/tags/event/</link><description>Recent content in event on yuasa's blog</description><generator>Hugo -- gohugo.io</generator><language>ja</language><copyright>© yuasa</copyright><lastBuildDate>Sat, 19 Oct 2024 00:14:33 +0900</lastBuildDate><atom:link href="/tags/event/index.xml" rel="self" type="application/rss+xml"/><item><title>Hardening 2024 Convolutions参加記</title><link>/posts/47/</link><pubDate>Sat, 19 Oct 2024 00:14:33 +0900</pubDate><guid>/posts/47/</guid><description>はじめに 2024年10月15~18日の日程で開催されたHardening 2024 Convolutions（ハードニング競技会）に参加しました。
ハードニング競技会は以下のようなものです（公式サイトより引用）。
ハードニング競技会は、サイバーセキュリティの実践的なスキルと知識を競うイベントです。参加者はチームを組み、競技会で託されるビジネス・ウェブサイト（例えばEコマースサイト）を、ビジネス目的を踏まえて運用・改善します。降りかかるあらゆる障害や攻撃に対して、考えうる手だてを尽くしてセキュリティ対応を実施しつつ、ビジネス成果が最大化できるよう準備を重ねます。
自分としては、2022年の競技会に参加して以来、2年ぶり2回目の参加となります。
Hardening 2024 Convolutionsの特徴 Hardening 2024 Convolutionsで特徴的だった点は以下です。
1チーム6、7人で全15チーム。 会場にリモートエリアとオフィスエリアが存在する。 オフィスエリアは1チーム4席のみなので、チームメンバーの数人はリモートエリアで作業する必要がある。 ジョイントベンチャー（JV）の制度が存在する。 JVは3チームから構成され、JVで運営するショップが1つ存在する。 メンターさんがいた。 メンターの方が競技当日まで、競技当日においてサポートをしてくださった。 自チームについて 技術担当4名、ビジネス担当3名で役割を分担しました。自分はチームリーダーを担当し、当日はビジネス業務とチーム全体の調整を行なっていました。状況把握と共有のため、オフィスエリアとリモートエリアを行ったり来たりしていました。
結果は、15チーム中9位でした。またスポンサー賞として、SCSK賞をいただきました。順位的にはそこまで良くないですが、優先度の高いショップはほとんど落とさず動かし続けられたのがとても良かったです。インシデントが立て続けに起こり続けるカオスな状況の中、ビジネスを存続するための意思決定と対応を行えたのはかなり良い経験になりました。
自チームにおいて良かった点と反省点をまとめます。
良かった点 競技当日までに環境への接続練習と簡易的なインシデント対応訓練を行った。 メンターさんが接続練習のための環境を提供してくださったのがかなりありがたかったです。 ochakai-hardeningを用いてインシデント対応訓練を実施。 テストプレイ1回目だったため色々と問題が生じましたが、チームメンバーの方々にパスワード変更とバックアップの重要性を伝えることができました。 インシデントが起こり続ける状況下でも、比較的冷静に対応し、コミュニケーションを取り続けることができた。 インシデントが起こった際に焦って個人作業になるのではなく、それぞれが状況の共有・報告を続けられたのはとても良かったです。 技術担当の方々はリモート・オフィスエリアに分かれていたため、Discordのボイスチャットでコミュニケーションを取り続けていました。 マーケットプレイスでシスコシステムズさんの製品を購入することができた。 NGFW/IPSによる不審な通信の遮断、EDRによる端末での不審なプロセス・タスクの検出に役立てられました。 特にEDRのWindows端末への導入によって、他チームが防げなかったLateral Movementを防げたのがとても良かったです。 また、シスコシステムズさんから通知される事象に対してFWで遮断を行うなどの対応ができたのが良かったです。 本来はシスコシステムズさんにリクエストすると製品で遮断してくださったらしい&amp;hellip; Webメールが使用できなくなった際に、Outlookへの切り替えがスムーズにできた。 顧客や各機関との連絡を行うためのWebメールが使用できなくなるインシデントが生じましたが、Outlookにスムーズに切り替えられたのが良かったです。 反省点 配送管理の概念を理解できていなかった。 在庫管理の必要な商品は購入された場合に配送を行わなければいけないことが分かっていなかったです（当たり前といえば当たり前）。 自チームでは配送を一切行っていなかったため、詐欺会社に成り果ててしまいました（しかしそこまで原点はなかった印象）。 dockerで立てられているアプリのバックアップが取れていなかった。 自チームで取れていないバックアップをJV内の他チームの方が提供してくださり、とても助かりました。 商品の人気レベルを上げるためのミッションに手をつけられていなかった。 ショップの商品画像や説明文を変更することで人気レベルを上げられるのですが、午後はインシデントの対応に追われて実施できませんでした。 比較的落ち着きのあった競技開始時にまとめて全部やっておくべきだったと思っています。 コーポレートサイトの改善ができなかった。 コーポレートサイトがダウンしたり、WordPressでブロックエディタが使えなくなる問題が生じたためコーポレートサイトを改善するミッションが達成できませんでした。 他チームの良かった点 Softening Dayの他チームの発表を聴いて良かった点、真似したいと思った点をまとめます。
Windows Defenderを有効化していたことで、マルウェア感染やLateral Movementを防げた。 すでにあるものを有効に活用することが重要だと気付かされました。 マーケットプレイスで人材系のサービスを購入していたことで、優秀な技術担当メンバーを増やすことができた。 インシデントの対応はもちろん、環境内の脆弱性を見つけて潰すところまでやってくださるそうで、強すぎないか？と思いました。 バックアップをgitで管理していた。 バックアップに差分が生じた場合も問題なく復元することができる。 人気レベルを上げた後に値段を倍に上げることで、売り上げを大幅に伸ばすことができた。 人気レベルを上げると値段を上げても購入されることが分かって、目から鱗でした。 チームビルディングのためにハート・ビーイングを行なった。 オンラインでのチームビルディングのために良好な関係を築くための工夫をしているのが素晴らしいと思いました。 呼び出しイベントのために報告書を作った。 謝罪会見などのイベントのために事前に報告書を作っていたことで質疑にきちんと回答ができていてすごかったです。 chagedetection.ioやiLogScannerなどのツールを用いた。 今後やってみたいこと 競技会への参加を通じて、今後やってみたいと思ったことをまとめます。</description></item><item><title>CODE BLUE 2023 参加記</title><link>/posts/42/</link><pubDate>Wed, 15 Nov 2023 00:02:22 +0900</pubDate><guid>/posts/42/</guid><description>はじめに 11月8、9日に開催されたCODE BLUE 2023に参加しました。自分の発表と印象に残った発表について振り返ります。
自分の発表について Blueboxのセッションで「OSBT: OpenID Connect Scenario-Based Tester」というタイトルで発表を行いました。Blueboxセッションの内容については以下参考。
Blueboxは本年新設されたコーナーで、さまざまなオープンソースツールやプロジェクトを紹介する場です。同時に、開発者・参加者の交流の場であり、プレゼンテーションやライブデモなども行われます。
発表概要 この発表ではOSBTというツールを紹介しました。OSBTはOpenID Connect実装のテストシナリオをプログラムで記述・実行可能なテストツールです。既存のOpenID Connectのテストツールはテストシナリオが内部に組み込まれており、各実装に適したテスト内容のカスタマイズができないという課題がありました。OSBTではテストシナリオをプログラムで記述・実行可能なため、テスト内容をカスタマイズでき、各OpenID Connect実装に適した脆弱性検証を行うために使用することができます。また、OSBTはGithub Actionsで利用可能なため、CI/CDパイプラインに組み込むことができます。
発表資料はこちらです。また、発表内で使用したデモ動画はこちらから確認できます。
また、今回の自分の発表はClassmethodのべこみんさんがブログで紹介してくださっています。発表終了後に爆速で投稿されていて驚きました。本当にありがとうございます！
Q&amp;amp;A 発表後のQ&amp;amp;Aコーナーで複数の質問をいただいたため、その質問と回答をまとめます。
Q. OSBTはOpenID Connectの実装者が、実装をテストするために使用できるツールですか？ A. そうです。テストシナリオは自身で記述する必要がありますが、記述することでOpenID Connectの各実装に適した脆弱性検証を行うことができます。 Q. githubレポジトリを見たのですが、Contributerが1人でした。1人で開発しているということですか？ A. そうです。今後は様々な方々に貢献していただけるようにしたいと考えています。 Q. Attacker IdPが必要になる攻撃はどのような状況で可能となりますか？ A. 例えば、RPにおいてユーザが使用するIdPを自由に選択できる場合に起こり得ます。プロトコル仕様ではRPはホワイトリストでユーザが使用するIdPを許可する必要があると示されますが、実際にはそのような実装になっていることがあります。 Q. 診断を行う際には認可コードやトークンを外部サービス（RequestBin）に送信したくないのですが、ローカルで通信を留めておくことはできますか？（OSBTでは認可コードやトークンの窃取可否を確認する際の送信先としてRequestBinを使用しているため） A. 現在、OSBTではRequestBinを使用しているためローカルで通信を留めておくことはできません。今後、ローカルで動作するリクエスト受信用のサーバを用意する予定です。 今後の方針 OSBTの今後の方針としては、SAMLなどその他のID連携プロトコルやFIDO2/WebAuthnなどの認証プロトコルの実装の検証にも対応できるような一般化、脆弱性検出能力を高めるためのテストシナリオの自動生成等を検討しています。今後はBlack HatのArsenalなどのカンファレンスで発表を行えるように頑張っていきます。
印象に残った発表について 聴講した発表はどれも質が高く素晴らしいものでしたが、着眼点や発表の仕方について特に印象深かったものを紹介します。発表の詳細については、Classmethodさんのブログや発表資料等をご参照ください。
macOSのセキュリティとプライバシーの機構をバイパスする手法について: Gatekeeper から System Integrity Protection まで macOSのセキュリティ・プライバシー機構を全てバイパスする手法を紹介するという非常に野心的な発表でした。技術的な内容はもちろんのこと、その発表の仕方についても、macOSにおいて表示されるポップアップなどのスクリーンショットを交えつつ、分野外の人も概要は理解できる発表になっていて素晴らしかったです。
Pwn2Ownのターゲットをハッキングした3年間の物語：攻撃、ベンダーの進化、そして教訓 Pwn2Ownにおける過去3年間の取り組みについて、経験やストーリーを交えつつ紹介するという発表でした。バグハンティングにおけるリアルな話（Fake bugやセキュリティチームとの闘いなど）や1つのターゲットを深く掘り下げていくことで得られる知見について、非常に興味深い内容でした。また、発表の中でたくさん笑いが起こっていたのも印象的でした。
stelftools: クロスアーキテクチャに対応した静的結合されたライブラリ関数の特定ツール IoTマルウェアに静的結合されたライブラリ関数を特定するためのツールであるstelftoolsを紹介する発表でした。IoTマルウェアの解析において、使用されているライブラリ関数を検出するために目でコードを解析する必要があるという現実的な課題に着目している点が印象的でした。stelftoolsは多くのアーキテクチャ、ツールチェーンをサポートしており、検出の精度も高いため、かなり実用的なツールだと思いました。また、発表はデモを主体とした構成になっており、聴講者を飽きさせないための工夫がなされていてとてもよかったです。
その他 Flatt Securityさん主催のSpeedrun CTFに参加していました。Speedrun CTFでありながら全完できず、5問中3問しか解けませんでした。4問目のJWT問が2時間くらいかけて解けなかったのがかなり悔しいです。しかし、良い問題ばかりでとても楽しかったです。
おわりに CODE BLUE 2023では様々な素晴らしい発表の聴講と、多くの方々との交流を行うことができました。また今後も発表者として参加できるように頑張っていきたいと思います。運営の方々、発表者の方々、参加者の方々、本当にありがとうございました。</description></item><item><title>SECCON Beginners Live 2023 「JWTセキュリティ入門」 チャレンジ問題 writeup</title><link>/posts/41/</link><pubDate>Tue, 26 Sep 2023 22:39:19 +0900</pubDate><guid>/posts/41/</guid><description>はじめに 2023年9月3日に開催されたSECCON Beginners Live 2023にて、「JWTセキュリティ入門」というタイトルでLT発表を行いました。
SECCON Beginners Live 2023「JWTセキュリティ入門」の資料です#seccon #ctf4bhttps://t.co/wwIxuxCTpX
&amp;mdash; JJ (yuasa) (@melonattacker) September 3, 2023 その際に出題したチャレンジ問題についての解法をまとめます。
JWTチャレンジの問題サーバはこちらですhttps://t.co/thiKxbpcyH
問題のソースコードはこちらから閲覧できますhttps://t.co/EYpv6bANE4
&amp;mdash; JJ (yuasa) (@melonattacker) September 3, 2023 問題 問題のソースコードはこちらです。
const express = require(&amp;#34;express&amp;#34;); const jwt = require(&amp;#34;jsonwebtoken&amp;#34;); const crypto = require(&amp;#34;crypto&amp;#34;); const PORT = 5504; const FLAG = &amp;#34;flag{this_is_trial3_flag}&amp;#34;; const app = express(); app.use(express.json()); // シークレットキーを生成 const secret = crypto.randomBytes(16).toString(&amp;#34;hex&amp;#34;); // 初期ユーザーを設定 const users = [ { id: &amp;#34;admin&amp;#34;, username: &amp;#34;admin&amp;#34;, password: crypto.</description></item><item><title>セキュリティキャンプ全国大会 2023 専門Bチューター参加記</title><link>/posts/39/</link><pubDate>Sun, 13 Aug 2023 22:19:17 +0900</pubDate><guid>/posts/39/</guid><description>はじめに セキュリティキャンプ全国大会 2023 に専門Bクラス（Webセキュリティクラス）のチューターとして参加しました。チューターとしてやったこと、講義の感想、その他感想を参加記としてまとめます。
チューターとしてやったこと チューターとしては主に、ハンズオンにおける受講生の技術面でのサポートと講義中の写真撮影を行なっていました。ハンズオンでのサポートについて、受講生の方々はセキュリティキャンプの応募課題を通過している方々であるため、技術面でのサポートはほとんど不要でした。しかし、windows環境でハンズオンが動かないことが多々あり、主にはwindows環境しか持ち合わせていない受講生の方々のサポートを行なっていました。講義中の写真については、受講生の方々が成果発表の時に活用されており、撮っていて良かったなと思いました。
講義の感想 Bクラスで受講した講義の感想をつらつらと書きます。
B1: Webプロダクトセキュリティへのいざない 5日間で学ぶ講義のイントロダクションについてのお話がありました。講義概要や事前学習をもとに受講生間で疑問点や明確にしたい点の洗い出しをディスカッションを通じて行いました。このような洗い出しを講義が始まる前に行うのは、受講する講義に対して万全な準備を整えておくために有益だと感じました。実際に、受講生の方々は事前に洗い出した疑問点や明確にしたい点を講義中の質問などで解消されていたように感じました。
B2: 開発プロセスを攻撃者の視点で捉える 前半2時間では、「攻撃者の視点を知る」というテーマで、仮想の学習塾へのペネトレ演習やレッドチームのお話がなされました。個人的には管理者権限の権限を駆使し、端末でコード実行することで窃取したCookieを用いてMFAを突破する部分が熱く痺れました。後半2時間では「攻撃者の視点を対策に活かす」というテーマで、CI/CD環境を具体例に攻撃側の目線を対策につなげるための手法を学びました。会社におけるセキュリティを考える際にはまずはシステムの全体像の「グラフ」を作成し、ATT&amp;amp;CKなどのフレームワークを用いた脅威分析によって可能な攻撃を「リスト」形式で明確にする。そして、具体的な防御策を考え、その対策がなぜ必要かを攻撃と紐付けて考えるという話が印象に残りました。
B3: クラウドネイティブセキュリティの実践と戦略 kubernetesを用いたローリングアップデートや水平スケーリング、サーキットブレーカーを用いた障害緩和、サイドカープロキシの自作などの演習を行い、クラウドネイティブ環境における脅威のお話がなされました。自分はkubectlコマンドを使ったこともないk8s完全初心者でしたが、演習を通じてkubernetesの利点とその実現方法が理解できました。kubernetesはとにかく複雑という印象がありましたが、ガチャガチャ触ってみるのが早いなという気持ちになりました。また、マイクロサービスにおいてはサービスを分割することによって、様々な脅威が存在しうるという点が印象的でした。
B4: Webサービスにおける安全な認証とID連携の実装 FIDO、WebAuthn、Passkeyなどの認証技術、ID連携技術であるOpenID Connectについてのお話がなされました。そして、Passkeyを用いたログイン機能とOpenID Connectを用いたID連携機能を実装する演習を行いました。OpenID Connectは自分の研究に密接に関わるためある程度理解ができていましたが、FIDO、WebAuthn、Passkeyなどの認証技術はざっくりとした理解しかできていなかったため、実装して実際に動作させることができてよかったです。また、FIDOで使用される端末のセキュア領域について興味があるため理解を深めていきたいです。
B5: 適応し続けるプロダクトとセキュリティ 不確実性のある環境下でプロダクトセキュリティにどのように向き合っていくべきかというお話がなされました。自分にとっては、探索と深化についての話がとても刺さりました。これは探索によって自身が手をつけられる領域を広げ、深化によって専門性を高めていくという話です。自分の場合は、深化だけをやりがちなので探索によって専門家と建設的な会話ができるレベルの領域を広げていきたいなと感じました。また、講師の方は自分の考えや経験を抽象化するのがとてもお上手な印象があり、思考のまとめ方としてとても参考になりました。
B6: ソースコード解析によるWebアプリケーションの脆弱性調査 CVEをベースとした脆弱性調査とCodeQLを用いた脆弱性調査の自動化を学びました。CodeQLはソースコードからコードに関するデータベースを作成して、それに対してクエリを投げて該当のコードを検索することができるツールです。ユーザが送信された値がアプリケーション内でどう伝搬していくかを追跡するTaint Trackingという手法をCodeQLを用いて自動実行することを演習として行いました。Log4shellのような値の伝搬が多く追跡が困難な脆弱性においても、CodeQLを用いると自動で追跡が可能になることを演習を通じて学びました。CodeQLはどんな脆弱性でも検出できる魔法のツールではありませんが、ソースコード内で生じる脆弱性についてあたりがつけられれば、追跡を自動化することで作業の大幅な効率化が可能になることを実感しました。
B7: Policy as Code入門 ポリシーを記述し、ポリシーに準拠しているかのチェックをコード化によって機械的に実施する「Policy as Code」について学びました。また、Policy as Codeの実装であるOpen Policy Agent（OPA）とその記述言語であるregoを用いて、ポリシーを記述する演習を行いました。様々な場面でポリシーを作成し、ポリシーに準拠しているかを継続的に検証することが求められるため、Policy as Codeの概念はそれを実現するために重要な概念であること実感しました。また、regoの記法はなかなかに独特で、特にイテレーション周りの理解が難しかったため、ポリシーの記述にはなかなかに苦戦しました。
その他感想 スケジュールがなかなかにハード 去年自分はオンラインでネクストキャンプに参加しており、その時もなかなかにスケジュールがハードな印象がありましたが、対面だと5倍増しでハードに感じました。朝早くから夜遅くまでプログラムが組まれており、7時くらいに起き、23時くらいに泥のように眠る規則正しい生活を送っていました。ハードなスケジュールをこなすことで、セキュリティに携わることで必要となる体力をつけさせる意図があるのではないかと考えました。ちなみに、チューターは施設からの外出を許可されていましたが、スケジュールがハードすぎたために期間中一度も施設から出ませんでした&amp;hellip;
ご飯は美味しい ご飯は毎日朝昼晩出ていたのですが、どれもとてもおいしかったです。特に2日目の昼食のカレーに入っていた豚肉？の食感がモキュモキュしており非常においしかったです。
交流がすごい 自分は期間中の交流に特別力を入れていた方ではないと思いますが、それでもたくさんの方々と名刺を交換しました。4日目の夜には名刺交換会なるものが行われ、名刺交換会の会場にはたくさんの人々が密集しており、熱気が凄まじかったです。個人的には、自分の研究分野に密接に関わるOpenID Connectについて話ができる人々と出会えて非常に嬉しかったです。また、自分が普段からXでお見かけしている偉大な技術者の方々の実在を確認できたのは大きな収穫でした。
おわりに チューターとして対面でセキュリティキャンプに参加できて非常によかったです。チューターとしては至らない点が多々あったかと思いますが、無事に終えることができて安心しています。また、来年から事業会社のPSIRTで働く予定の自分にとって今年のBクラスの講義は全て業務に直結するであろう内容であったため、Bクラスのチューターに応募して本当に良かったなと思いました。セキュリティキャンプ 2023に携わった全ての方々、本当にお世話になりました。そして、ありがとうございました。</description></item><item><title>Hardening Decade 2022参加記</title><link>/posts/28/</link><pubDate>Wed, 16 Nov 2022 11:42:45 +0900</pubDate><guid>/posts/28/</guid><description>はじめに 11月15、16、19日に渡って開催されたHardening Decade 2022に参加しました。
ハードニング競技会は、基本的に、チームに託されたウェブサイト(例えばEコマースサイト)を、ビジネス目的を踏まえ、降りかかるあらゆる障害や攻撃に対して、考えうる手だてを尽くしてセキュリティ対応を実施しつつ、ビジネス成果が最大化するよう調整する力を競うものです。
この競技会は第一日目のHardening Day、第二日目のAnalysis Day、第三日目のSoftening Dayの三日間で開催されました。また、競技の1ヶ月半前くらいにチーム分けが発表され、各チームは競技までの期間に準備を進めることになります。
競技前の期間 競技の1ヶ月半前くらいにチーム分けが発表された後、チームで一週間に一度ミーティングを行っていました。役割分担をした後、各メンバーがやるべきタスクが割り出され、タスクの進捗確認を行っていました。
私はwebサーバ、Docker、EC-CUBE（競技に用いられるECサイト）の担当になったので、競技当日に参照できるようなチートシートを作成していました。
ミーティングは過去のハードニング競技会参加者の方々が進行してくださり、円滑に進んでいました。また、ミーティングの最初にメンバーが最近あったことを話す期間が設けられており、チームに打ち解けやすいように感じました。
第一日目: Hardening Day 第一日目はHardening Day（競技当日）です。9:00に会場の万国津梁館に集合し、9:40くらいから競技が開始されました。競技開始から1時間は攻撃がこない時間なので、その間にLinuxサーバのユーザのパスワード変更、各種バックアップの取得などを行いました。私はwebサイトが稼働しているサーバ4台の管理を担当していたので、その後はアクセスログを監視したり、脆弱な設定やコードを修正する作業をすることを考えていました。
自分のやらかし Dockerコンテナが動作しているサーバで脆弱な設定がなされていました。その設定を変更した後にコンテナを再起動すると、コンテナ間通信で名前解決ができないエラーが出ました。そこでだいぶ焦ってしまい、コンテナを一旦削除してまた起動することを考えました。実際コンテナにvolumeが設定されており、重要な部分のデータは永続化されているので、コンテナを削除してもまあ大丈夫だろうという軽い気持ちでした（後で確認すると一部重要volumeが設定されていなかったが）。
しかし、使用されているイメージが予想外の仕様でコンテナ起動時にwebサーバを起動すると、その後にweb管理画面からの操作でソフトウェアのインストールを要するタイプのものでした。競技環境からインターネットには接続できないのでこの時はかなり絶望的な気持ちになりました。一旦落ち着いて、復旧できないかを試してみようという気持ちになり復旧を頑張ることにしました。volumeがとれていない部分ではあったのですが、なんとかvolumeから復旧できないか試したりしました。
結局、自力では無理そうだということがわかり、運営の方に質問をしたところ復旧は不可能だろうという旨の答えが返ってきました。なので、一旦落ち着いてひとつのwebサイトを動作させるのを諦めることにしました。幸い売り上げには直結しないサイトでした（おそらく減点はありましたが&amp;hellip;）。
ネットワークトラブル 競技の途中でネットワークトラブルが発生しました。計3時間以上の間、ファイヤウォールと公開サーバ間の通信が断続的に不安定になり、ほとんどサーバ内で作業することができない状態になりました。ネットワークのプロの方が調査をしてくださったところ、停止しているサーバあてにファイヤウォールが大量のARPリクエストを送りつけた結果、L2環境がダウンしたことが原因であることがわかりました。停止しているサーバは実態のわからず、特に使用されていないものだったので停止されていたのですが、どうやら停止するのはあまりよくなかったようです。その後、停止しているサーバを起動して、ARPリクエストに答える状況にすることで復旧できたようです。自分はこのレイヤーのことをあまり理解していないため、何もできなかったことが悔しかったです。L2環境がダウンすると、こちらからは操作が全くできないので、L2、L3の技術やインシデント対応力を身につけることは重要だと身にしみて実感しました。
偉大なるWAF マーケットプレイスにてバラクーダさんのブリッジ型WAFを購入することができていました。競技終了後に提供していただいたログを見ると、かなりのweb経由での攻撃を止めてくださっていました。実際、個人情報漏洩インシデントなどは発生せず、呼び出しなどはありませんでした。webサーバのアクセスログを監視しているとWAFを回避してくる攻撃が確認できましたが、webサイトを遅延する攻撃などしかなく、影響度の大きい攻撃は確認できませんでした。また、バラクーダさんに依頼するとWAFの検知ルールを追加することができ、その点でも非常に助かりました。製品として提供されているWAFの防御力の高さを実感することになりました。
競技終わり、パーティ その後、競技は18:00まで行われました。競技開始から8時間ほどほとんど休憩なしに集中モードで取り組んでいたため、かなり疲弊しました。なかなか普段ではそこまで長時間集中することはないので、かなり充実した時間でした。
競技終了後はパーティーが開催されました。名物の泡盛を飲んだり、歌を聞いたり踊ったりしながら楽しい時間を過ごしました。同じチームの方々や他のチーム、企業の方々とも交流を深めることができ、非常に良いパーティでした。
第二日目: Analysis Day 第二日目はAnalysis Day（各チームでの振り返り日）です。各チーム、コワーキングスペースなどに集合してHardening Dayの振り返りを行いました。この際にSoftening Dayの発表資料のドラフトを作成しました。また、チーム内でHardeningの練習用環境欲しいけどそれが出たら対策が出来過ぎそうという話が出ており、自分は帰り際に以下のようなことを考えていました。
小規模なHardening環境をある程度ランダムに生成してデプロイ、攻撃も自動生成して実行してくれるやつ作りたい
&amp;mdash; JJ (yuasa) (@melonattacker) November 16, 2022 来年もHardeningに参加したいと考えているので、その対策も兼ねてこれから作っていきたいと考えています。
第三日目: Softening Day 第三日目はSoftening Day（全体での振り返り日）です。Softening Dayでは各チームのやタスクフォース（連合チームのCISOの集まり）からの発表、攻撃チーム、インフラチームからの発表、表彰式などが行われました。せっかくの良い機会だと思ったので、チーム発表をさせていただきました。
攻撃チームからの発表はやはり学ぶことが多かったです。しかし、思ったよりも攻撃チームはwebサイトを破壊したり止めたりしていないことがわかりました。セキュリティ対策を実施しつつ、webサイトの運用をすることは簡単ではないということがわかりました。
また、インフラチームからは発生したネットワークトラブルについての説明がありました。どうやら再現性はあるものの、直接的な原因はまだ分かっていないようです。かなり複雑そうな問題なので、来年までに原因を究明していただきたいです。
長時間に渡って発生したネットワークトラブルの影響が大きかったようで、成績は最下位でした（泣）。しかし、バラクーダさんのWAFをしっかり活用していたことを評価していただき、バラクーダ賞をいただきました。アマギフ1万円分ありがとうございます。
おわりに 今回初めてHardeningに参加して、リアルタイムでのインシデント対応の難しさを感じました。また、セキュリティ対策を実施しつつ、webサイトを運用することの難しさも知りました。今回の参加で、Hardeningでどんなことが起きるのか、どのような対策・対応をすれば良いかが大体把握できたので、次回以降の参加に生かしたいと思います。未熟な自分に発表をさせてくださった同じチームのみなさん、運営のみなさん、スポンサーのみなさん、本当にありがとうございました。</description></item><item><title>MWS Cup 2022参加記兼writeup（DFIR）</title><link>/posts/26/</link><pubDate>Wed, 26 Oct 2022 15:33:08 +0900</pubDate><guid>/posts/26/</guid><description>はじめに 10月25日にComputer Security Symposium 2022 in Kumamotoで開催されたMWS Cup 2022（マルウェア解析のコンペ）に参加しました。自分の所属する研究室では毎年、修士課程の学生がMWS Cupに出場しており、自分も今年はM1の同期とともにチーム「卍脳筋鹿煎餅卍NEO」として出場することとなりました（チーム名は伝統に基づき決定）。
MWSCup 2022 今年のMWS Cupは以下の4課題から構成され、各課題25点で合計100点の配点となっていました。
課題1: ハッカソン 課題2: 静的解析 課題3: 表層データ解析（Kaggle) 課題4: DFIR ハッカソンは事前に動画での発表が行われ、評価が行われます。また、課題3の表層データ解析（Kaggle）は3日程前から当日までKaggleでのコンペティションが行われ、課題2、4は当日にCTF形式で行われました。
ハッカソン ハッカソンではサイバーセキュリティ関わるオープンなツールやデータセットを作成します。自分たちのチームは「セキュアなメールクライアント」を実装しました。
開発したメールクライアントはセキュリティのための2つの機能を持っています。一つ目の機能は「不審なURLの強調表示」です。メールに記載される不審なURLを機械学習を用いて検出し、強調して表示することで不用心なクリックを防止します。二つ目の機能は「サンドボックス環境でのファイルの無害化」です。専用のDockerコンテナ内で有害なOfficeファイルの無害化を行うことで、Officeファイル経由でのマルウェア感染を防ぎます。
開発後は動画にて発表を行い、以下のレポジトリに成果をまとめました。
フロントエンド: https://github.com/nokinsikasenbei-neo/sandbox-email-front バックエンド: https://github.com/nokinsikasenbei-neo/sandbox-email-back 当日までの準備期間 自分のチームは4人しかいなかったため、4つの課題に対して一人ずつ担当者を配置する方針で進めていました。ちなみにここ数年のMWS Cupは事前課題としてハッカソンがあり、課題1がDrive by Download, Exploit Kit解析でした。自分はこのDrive by Download, Exploit Kit解析を担当する予定で直前まで学習を進めていましたが、2日前に運営からのアナウンスで今年は課題1が消滅していることが明らかになりました（悲しみ）。
仕方ないので、自分は課題4のDFIRをチームメンバーのiwasakiとともに担当することとなりました。DFIRはログを解析して、インシデントの原因・内容を調査するというものです。前日に2021年の過去問の解き直しをiwasakiとともに行い、どのような流れで進めるかを確認しました。自分はVS Codeとシェルコマンドを用いてログ解析をしようと考えていましたが、iwasakiがsplunk enterpriseという便利解析ツールを用いており、かなり自分より手際が良かったので自分もsplunkを用いることにしました。
当日（DFIR writeup） 当日は9:00~13:00まで競技が行われ、14:20~17:20まで解説が行われました。以下で自分が担当していた課題4のwriteupを記します。ちなみに、公式の解法の方がスマートな解法なことが多いのでそちらの方が参考になるかと思われます（公式の解法が公開され次第URLを記載します）。
1.1 Initial Access/Execution (1pt) SwanがExcelのプロセスを起動した日時(日本時間)と開いたファイル名を答えよ。
フォーマット: YYYY/MM/DD_hh:mm:ss_ファイル名 例: 2022/10/24 09:00:00 に test.xlsx を開いた場合、2022/10/24_09:00:00_test.xlsx 5回まで回答可
Swanがexcelのプロセスを起動しているログを探します。こちらはiwasakiが見つけてくれました。
ユーザーSwanがC:\Users\Swan\Desktop\tomatet.xlsmというファイルを開いています。.xlsmファイルはExcel2007以降のマクロ付きExcelファイルに付く拡張子だそうです。
答え: 2022/10/05_14:21:02_student_grades.xlsx
1.2 Initial Access / Execution (1pt) Swanが 問題1.</description></item><item><title>セキュリティキャンプ全国大会に参加しそびれ悲しみに暮れていた老人がネクストキャンプに参加した話</title><link>/posts/23/</link><pubDate>Fri, 12 Aug 2022 20:49:26 +0900</pubDate><guid>/posts/23/</guid><description>はじめに 8月8日〜12日に開催されたセキュリティ・ネクストキャンプ 2022 オンラインというイベントに参加しました。このイベントは25歳以下の学生や社会人対して情報セキュリティに関する教育を行うプログラムです。セキュリティキャンプ 全国大会と並行に開催されました。全国大会は22歳以下が参加できます。
実を言うと自分は、当初全国大会に応募する予定でした。応募時点で22歳だったため、参加できるだろうと思っていました。しかし、応募要項を見ると「2023年3月31日終了時点において22歳以下」であることが必須であることがわかり、全国大会にはもう参加できないことを悟りました。セキュリティを学ぶ若者の中では自分はもう年齢が高い層にいる（老人）という事実に気付かされ、悲しみに暮れました。
しかし、自分が所属しているCTFチームの先輩が昨年度ネクストキャンプに参加しており、話を聞いていた中で面白そうだと思っていたため、ネクストキャンプに応募することにしました。そして無事に参加できることとなりました。
特に面白かった講義3選 今年のネクストキャンプでは以下の全7講義が開講されました。
Linux Networking Programmability入門 CanSatをはじめよう TDD+モブプログラミング プログラミング言語を自作しよう バイナリ生物学入門 ソーシャルとマンガを活用した持続可能なセキュリティ啓発 RF（電波）攻防戦演習 どの講義も面白かったのですが、自分が特にためになった、面白かったと感じた講義を3つ紹介します。
Linux Networking Programmability入門 「Linux Networking Programmability入門」の講義では、仮想ネットワーク構築ツールであるtinetを用いて、Linuxのネットワーク機能を用いた実験を行いました。実験では、L2のトンネリングプロトコルであるGeneveとVXLANを用いて通信を行い、キャプチャしたパケットを見て比較したり、AS間で経路情報を交換するプロトコルであるBGPを用いて通信を行ったりしました。最も重要だと感じたのは、ネットワークの専門家である講師の方が「Linux OS一つあればネットワークのプロになれる」とおっしゃっていたことです。Linuxのネットワーク機能は充実しているため、tinetを用いて様々なネットワークを構築し、パケットをキャプチャして構造を確認するプロセスを繰り返すことでかなりネットワークに詳しくなれるとのことです。他の講義と比べて2時間と時間が短かったですが、かなり充実感のある内容でした。
TDD+モブプログラミング 「TDD+モブプログラミング」の講義では、TDDかつモブプログラミングで逆ポーランド記法電卓やLispインタプリタを実装する演習を行いました。TDDはテスト駆動開発のことで、「まず実施するテストを書き、テストを実行して失敗させる、その後に関数を実装してテストをパスさせる」というサイクルを繰り返します。モブプログラミングは、3人以上で行うプログラミングで、コードを書くドライバーとドライバーに指示を出すナビゲーターに分かれて開発を行います。自分は2人で行うペアプロは経験がありましたが、モブプロに関しては経験がありませんでした（モブプロのことをモブキャラがするプログラミングのことだと思っていたことは秘密）。実際にやってみると、テストが複雑になってしまったり、ドライバーが一人で実装を進めてしまったりとTDDとモブプロの両方で問題が発生しました。しかし、最終的にはいい感じに進めることができるようになり、TDD+モブプロの良さを実感することができました。今後、複数人で複雑な実装を行う場合などにはぜひTDD+モブプロで開発したいと思います。
バイナリ生物学入門 「バイナリ生物学入門」の講義では、バイナリを生物として扱うことで進化的にバイナリを生成する「バイナリ生物学」という新たな学問を学びました。また、daisy-toolsを用いて進化的にバイナリを生成する演習を行いました。正直、講義を受ける前は「なんだこの怪しい講義は&amp;hellip;」と思っていたのですが、講義を受けてみると面白さが理解でき、怪しいものではないことが分かりました。何よりも面白いのは講師の方が一人でこの学問を生み出しておられることです。自分は思い返してみると今までの人生で、講師の方が作った学問を自分で教えているケースに出くわした事がないなと思い、新たな概念を生み出すことの素晴らしさを感じました。実際にバイナリを進化的に生成すると、なかなか実用的なバイナリを自動生成することは難しいことが分かりました。しかし、まだまだ理論に改良の余地は残されており、今後も講師の方によって改良がなされたり、バイナリ生物学の新たな流派を作る人が現れたりするのかなと想像するとワクワクしました。
全体的な感想 ネクストキャンプの他の受講生の方々は優秀な方が多い印象でした。セキュリティに興味がある同年代の優秀な方々と演習などを通じて交流できたのはとても良い機会でした。また、ジュニア（小中学生）や全国大会の方々の成果発表などを聞いて、技術へのこだわりや熱量がかなり高いと感じました。そして、全国大会の講義で面白そうなものがいくつもあった（特にプロダクトセキュリティのBトラック）ので、その公開資料を見るなどして勉強したいと思っています。
おわりに n年後に講師としてセキュリティキャンプに参加したいと思いました。そのために、自分の専門分野を極めつつ発信も積極的にしていこうと考えています。また、チューターというポジションが魅力的だということも分かりました。チューターになって受講生のサポートをしつつ、自分が受講生として参加しそびれた全国大会の講義を聞くのも良さそうだと思っています。とにかく今回のキャンプを通じてかなりの刺激を受けたので、これを利用していっぱいﾊﾟｿｺﾝｶﾀｶﾀしたいと思います。
関係ない余談 : ラスベガスに行っている方々のツイートがかなり羨ましいので、力をつけて数年後にはなんらかの形で、8月のラスベガスのセキュリティイベントの参加パスを獲得したいです。</description></item></channel></rss>